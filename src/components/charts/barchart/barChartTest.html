<!-- Test File to test the script "barChartScript" of file BarchartLogic -->
<div id="chart-tt-wrapper"><text class="chart-tt" data-font-family="Javanese Text" data-font-size="20px" data-line-height="23px" data-max-width="240px" data-padding="30px" data-background-color="rgba(248, 243, 243, 1)" data-text-color="rgba(65, 77, 225, 1)" style="visibility: hidden; display: inline; position: absolute; text-align: left; font-family: Javanese Text; font-size: 20px; line-height: 23px; max-width: 240px; max-height: 800px; padding: 30px; background-color: rgb(248, 243, 243); color: rgb(65, 77, 225); border-radius: 8px; pointer-events: none; transform: translate(-100%, -100%); left: 884px; top: 663px;">111: 6<br><br>Absolute Häufigkeiten: 84</text></div><div id="barchart"><svg id="barchartSVG" width="1000" height="600"><rect class="backgroundBarChart" height="600" width="1000" fill="rgba(240, 210, 210, 1)"></rect><g class="containBarChart" transform="translate(180,120)"><g class="y-axis" fill="none" font-size="10" font-family="sans-serif" text-anchor="end"><g class="tick" opacity="1" transform="translate(0,360.5)"><line stroke="rgba(99, 95, 93, 1)" x2="640" stroke-width="1"></line><text fill="rgba(214, 97, 42, 1)" x="-10" dy="0.32em" font-size="20" font-family="Javanese Text">0</text></g><g class="tick" opacity="1" transform="translate(0,327.77272727272725)"><line stroke="rgba(99, 95, 93, 1)" x2="640" stroke-width="1"></line><text fill="rgba(214, 97, 42, 1)" x="-10" dy="0.32em" font-size="20" font-family="Javanese Text">20</text></g><g class="tick" opacity="1" transform="translate(0,295.0454545454545)"><line stroke="rgba(99, 95, 93, 1)" x2="640" stroke-width="1"></line><text fill="rgba(214, 97, 42, 1)" x="-10" dy="0.32em" font-size="20" font-family="Javanese Text">40</text></g><g class="tick" opacity="1" transform="translate(0,262.3181818181818)"><line stroke="rgba(99, 95, 93, 1)" x2="640" stroke-width="1"></line><text fill="rgba(214, 97, 42, 1)" x="-10" dy="0.32em" font-size="20" font-family="Javanese Text">60</text></g><g class="tick" opacity="1" transform="translate(0,229.5909090909091)"><line stroke="rgba(99, 95, 93, 1)" x2="640" stroke-width="1"></line><text fill="rgba(214, 97, 42, 1)" x="-10" dy="0.32em" font-size="20" font-family="Javanese Text">80</text></g><g class="tick" opacity="1" transform="translate(0,196.86363636363635)"><line stroke="rgba(99, 95, 93, 1)" x2="640" stroke-width="1"></line><text fill="rgba(214, 97, 42, 1)" x="-10" dy="0.32em" font-size="20" font-family="Javanese Text">100</text></g><g class="tick" opacity="1" transform="translate(0,164.13636363636365)"><line stroke="rgba(99, 95, 93, 1)" x2="640" stroke-width="1"></line><text fill="rgba(214, 97, 42, 1)" x="-10" dy="0.32em" font-size="20" font-family="Javanese Text">120</text></g><g class="tick" opacity="1" transform="translate(0,131.4090909090909)"><line stroke="rgba(99, 95, 93, 1)" x2="640" stroke-width="1"></line><text fill="rgba(214, 97, 42, 1)" x="-10" dy="0.32em" font-size="20" font-family="Javanese Text">140</text></g><g class="tick" opacity="1" transform="translate(0,98.68181818181817)"><line stroke="rgba(99, 95, 93, 1)" x2="640" stroke-width="1"></line><text fill="rgba(214, 97, 42, 1)" x="-10" dy="0.32em" font-size="20" font-family="Javanese Text">160</text></g><g class="tick" opacity="1" transform="translate(0,65.95454545454544)"><line stroke="rgba(99, 95, 93, 1)" x2="640" stroke-width="1"></line><text fill="rgba(214, 97, 42, 1)" x="-10" dy="0.32em" font-size="20" font-family="Javanese Text">180</text></g><g class="tick" opacity="1" transform="translate(0,33.22727272727274)"><line stroke="rgba(99, 95, 93, 1)" x2="640" stroke-width="1"></line><text fill="rgba(214, 97, 42, 1)" x="-10" dy="0.32em" font-size="20" font-family="Javanese Text">200</text></g><g class="tick" opacity="1" transform="translate(0,0.5)"><line stroke="rgba(99, 95, 93, 1)" x2="640" stroke-width="1"></line><text fill="rgba(214, 97, 42, 1)" x="-10" dy="0.32em" font-size="20" font-family="Javanese Text">220</text></g><text class="axis-label" transform="rotate(-90)" text-anchor="middle" y="-100" x="-180" font-family="Javanese Text" font-size="20" fill="rgba(142, 136, 131, 1)">Absolute Häufigkeiten</text></g><g class="x-axis" transform="translate(0, 360)" fill="none" font-size="10" font-family="sans-serif" text-anchor="middle"><g class="tick" opacity="1" transform="translate(78.49056603773582,0)"><line stroke="rgba(99, 95, 93, 1)" y2="6" stroke-width="1"></line><text fill="rgba(214, 97, 42, 1)" y="16" dy=".15em" text-anchor="end" dx="-.8em" font-size="20" font-family="Javanese Text" transform="rotate(-30)">4</text></g><g class="tick" opacity="1" transform="translate(199.2452830188679,0)"><line stroke="rgba(99, 95, 93, 1)" y2="6" stroke-width="1"></line><text fill="rgba(214, 97, 42, 1)" y="16" dy=".15em" text-anchor="end" dx="-.8em" font-size="20" font-family="Javanese Text" transform="rotate(-30)">8</text></g><g class="tick" opacity="1" transform="translate(319.99999999999994,0)"><line stroke="rgba(99, 95, 93, 1)" y2="6" stroke-width="1"></line><text fill="rgba(214, 97, 42, 1)" y="16" dy=".15em" text-anchor="end" dx="-.8em" font-size="20" font-family="Javanese Text" transform="rotate(-30)">6</text></g><g class="tick" opacity="1" transform="translate(440.754716981132,0)"><line stroke="rgba(99, 95, 93, 1)" y2="6" stroke-width="1"></line><text fill="rgba(214, 97, 42, 1)" y="16" dy=".15em" text-anchor="end" dx="-.8em" font-size="20" font-family="Javanese Text" transform="rotate(-30)">3</text></g><g class="tick" opacity="1" transform="translate(561.5094339622641,0)"><line stroke="rgba(99, 95, 93, 1)" y2="6" stroke-width="1"></line><text fill="rgba(214, 97, 42, 1)" y="16" dy=".15em" text-anchor="end" dx="-.8em" font-size="20" font-family="Javanese Text" transform="rotate(-30)">5</text></g><text class="axis-label" y="50" x="320" font-size="40" font-family="Javanese Text" fill="rgba(235, 128, 39, 1)">111</text></g><g class="titleChart"><text class="titleChart" text-anchor="middle" x="320" y="-20" fill="rgba(234, 111, 197, 1)" font-size="50" font-family="Javanese Text">Agdfg</text></g><rect class="bar" opacity="1" x="36.226415094339586" y="26.18181818181819" width="84.52830188679245" height="333.8181818181818" fill="#7fc97f" data-x="204" data-y="4"></rect><rect class="bar" opacity="1" x="156.98113207547166" y="191.45454545454544" width="84.52830188679245" height="168.54545454545456" fill="#beaed4" data-x="103" data-y="8"></rect><rect class="bar" opacity="1" x="277.73584905660374" y="222.54545454545453" width="84.52830188679245" height="137.45454545454547" fill="#fdc086" data-x="84" data-y="6"></rect><rect class="bar" opacity="1" x="398.4905660377358" y="353.45454545454544" width="84.52830188679245" height="6.545454545454561" fill="#ffff99" data-x="4" data-y="3"></rect><rect class="bar" opacity="1" x="519.2452830188679" y="355.09090909090907" width="84.52830188679245" height="4.909090909090935" fill="#386cb0" data-x="3" data-y="5"></rect><text text-anchor="middle" class="barValue" font-size="20" font-family="Javanese Text" fill="rgba(214, 97, 42, 1)" x="78.49056603773582" y="21.18181818181819" opacity="1">204</text><text text-anchor="middle" class="barValue" font-size="20" font-family="Javanese Text" fill="rgba(214, 97, 42, 1)" x="199.2452830188679" y="186.45454545454544" opacity="1">103</text><text text-anchor="middle" class="barValue" font-size="20" font-family="Javanese Text" fill="rgba(214, 97, 42, 1)" x="319.99999999999994" y="217.54545454545453" opacity="1">84</text><text text-anchor="middle" class="barValue" font-size="20" font-family="Javanese Text" fill="rgba(214, 97, 42, 1)" x="440.754716981132" y="348.45454545454544" opacity="1">4</text><text text-anchor="middle" class="barValue" font-size="20" font-family="Javanese Text" fill="rgba(214, 97, 42, 1)" x="561.5094339622641" y="350.09090909090907" opacity="1">3</text></g></svg></div>


<script>
    const tooltipWrapper = document.getElementById("chart-tt-wrapper");
    const tooltip = tooltipWrapper.getElementsByClassName("chart-tt")[0];
    const svg = document.getElementById("barchartSVG");
    const axislabels = svg.querySelectorAll(".axis-label");
    const bars = svg.querySelectorAll(".bar");
    const barValues = svg.querySelectorAll(".barValue");
    const containBarChart = svg.getElementsByClassName("containBarChart")[0];

    const tooltipFontFamily = tooltip.getAttribute("data-font-family");
    const tooltipFontSize = tooltip.getAttribute("data-font-size");
    const tooltipLineHeight = tooltip.getAttribute("data-line-height");
    const tooltipMaxWidth = tooltip.getAttribute("data-max-width");
    const tooltipPadding = tooltip.getAttribute("data-padding");
    const tooltipBgColor = tooltip.getAttribute("data-background-color");
    const tooltipTextColor = tooltip.getAttribute("data-text-color");

    const normalStyle = `visibility: hidden; display: inline; position: absolute; text-align: left; max-width: ${tooltipMaxWidth}; max-height: 800px; padding: ${tooltipPadding}; border-radius: 8px; font-size: ${tooltipFontSize}; font-family: ${tooltipFontFamily}; line-height: ${tooltipLineHeight}; background-color: ${tooltipBgColor}; color: ${tooltipTextColor}; pointer-events: none; transform: translate(-100%, -100%);`;
    const hoverStyle = `visibility: visible; display: inline; position: absolute; text-align: left; max-width: ${tooltipMaxWidth}; max-height: 800px; padding: ${tooltipPadding}; border-radius: 8px; font-size: ${tooltipFontSize}; font-family: ${tooltipFontFamily}; line-height: ${tooltipLineHeight}; background-color: ${tooltipBgColor}; color: ${tooltipTextColor}; pointer-events: none; transform: translate(-100%, -100%);`;

    function mouseover(){
        tooltip.setAttribute("style", hoverStyle);
    };
    function mousemove(event, barXdata, barYdata){
        mousePos = { x: event.clientX, y: event.clientY };
        tooltip.setAttribute("style", hoverStyle + `left: ${mousePos.x}px; top: ${mousePos.y}px`);
        tooltip.innerHTML = `${axislabels[1].textContent}: ${barYdata}<br><br>${axislabels[0].textContent}: ${barXdata}`;
    };
    function mouseout(){
        tooltip.setAttribute("style", normalStyle);
    };

    function mouseenter(bar) {
        bars.forEach((barEl) => {
            barEl.setAttribute("opacity", "0.7");

            if (barEl != bar) {
                const textEl = document.createElementNS("http://www.w3.org/2000/svg", "text");
                textEl.setAttribute("class", "divergence");
                textEl.setAttribute("fill", "#634F5D");
                textEl.setAttribute("font-size", "13px");
                textEl.setAttribute("text-anchor", "middle");
                textEl.setAttribute("x", Number(barEl.getAttribute("x")) + Number((barEl.getAttribute("width")) / 2));
                textEl.setAttribute("y", barEl.getAttribute("y") - 5);

                const divergence = (barEl.getAttribute("data-x") - bar.getAttribute("data-x")).toFixed(0);
                textEl.textContent = divergence > 0 ? "+" + divergence : divergence;

                containBarChart.append(textEl);
            }
        });
        bar.setAttribute("opacity", "1");
        barValues.forEach((value) => {
            value.setAttribute("opacity", "0");
        });
    }

    function mouseleave () {
        const divergenceText = containBarChart.querySelectorAll(".divergence");
        divergenceText.forEach((text) => {
            text.remove();
        });

        barValues.forEach((value) => {
            value.setAttribute("opacity", "1");
        });
        bars.forEach((bar) => {
            bar.setAttribute("opacity", "1");
        });
    };

    bars.forEach((bar) => {
        const barXdata = bar.getAttribute("data-x");
        const barYdata = bar.getAttribute("data-y");

        bar.addEventListener("mouseover", mouseover);
        bar.addEventListener("mousemove", (event) => mousemove(event, barXdata, barYdata));
        bar.addEventListener("mouseout", mouseout);
        bar.addEventListener("mouseenter", () => mouseenter(bar));
        bar.addEventListener("mouseleave", mouseleave);
    });
</script>